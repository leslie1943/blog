## å…³äº Babel é‚£äº›äº‹å„¿

### â­ ä»€ä¹ˆæ˜¯Babel?
- ä»€ä¹ˆæ˜¯`Babel` æ˜¯ä¸€ä¸ª `JavaScript` ç¼–è¯‘å™¨, ç”¨äºå°† `ES2015+`çš„ä»£ç è½¬æ¢ä¸ºå‘åå…¼å®¹çš„`JavaScript`è¯­æ³•, ä»¥ä¾¿èƒ½å¤Ÿåœ¨å½“å‰ç‰ˆæœ¬æˆ–è€…æ—§ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­è¿è¡Œ. ç®€å•æ¥è¯´, Babel çš„å·¥ä½œ
```bash
    # è¯­æ³•è½¬æ¢
    # é€šè¿‡Polyfillçš„æ–¹å¼åœ¨ç›®æ ‡ç¯å¢ƒä¸­æ·»åŠ ç¼ºå¤±çš„å±æ€§
    # JS æºç è½¬æ¢.
```

### â­ Babel çš„åŸºæœ¬åŸç†
- `Babel`çš„åŸç†: æ ¸å¿ƒå°±æ˜¯ AST (æŠ½è±¡è¯­æ³•æ ‘), é¦–å…ˆå°†æºç æŠ½è±¡æˆè¯­æ³•æ ‘, ç„¶åå¯¹è¯­æ³•æ ‘è¿›è¡Œå¤„ç†ç”Ÿæˆæ–°çš„è¯­æ³•æ ‘,æœ€åå°†æ–°è¯­æ³•æ ‘ç”Ÿæˆæ–°çš„ JS ä»£ç .
- æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸º3ä¸ªé˜¶æ®µ: `parsing(è§£æ)` ===> `transforming(è½¬æ¢)` ==> `generating(ç”Ÿæˆ)` 
- `Babel`åªè´Ÿè´£è½¬è¯‘ç¼–è¯‘æ–°æ ‡å‡†å¼•å…¥çš„æ–°è¯­æ³•,æ¯”å¦‚ `Arrow function`, `Class`, `ES Module`, ä¸ä¼šç¼–è¯‘åŸç”Ÿå¯¹è±¡æ–°å¼•å…¥çš„æ–¹æ³•å’ŒAPI, æ¯”å¦‚`Array.inclues`,`Map`,`Set`ç­‰, è¿™äº›é `Polyfill`æ¥è§£å†³.

### â­ Babel çš„ä½¿ç”¨

#### è¿è¡Œ babel æ‰€éœ€çš„åŸºæœ¬ç¯å¢ƒ
- 1): `babel/cli` ===> `npm install i -S @babel/cli`
```bash
    #@babel/cli æ˜¯ Babel æä¾›çš„å†…å»ºå‘½ä»¤è¡Œå·¥å…·. 
    # æåˆ° @babel/cli è¿™é‡Œå°±ä¸å¾—ä¸æä¸€ä¸‹ @babel/node,è¿™å“¥ä¿©è™½ç„¶éƒ½æ˜¯å‘½ä»¤è¡Œå·¥å…·,ä½†æ˜¯ä½¿ç”¨åœºæ™¯ä¸åŒ,babel/cli æ˜¯å®‰è£…åœ¨é¡¹ç›®ä¸­,è€Œ @babel/node æ˜¯å…¨å±€å®‰è£…. 
```
- 2): `@babel/core` ===> `npm install i -S @babel/core`
```bash
    # ğŸ›´1- å®‰è£…å®Œ @babel/cli åå°±åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œbabel test.jsä¼šæŠ¥æ‰¾ä¸åˆ° @babel/core çš„é”™è¯¯, å› ä¸º @babel/cli åœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šä¾èµ– @babel/core æä¾›çš„ç”Ÿæˆ AST ç›¸å…³çš„æ–¹æ³•, æ‰€ä»¥å®‰è£…å®Œ @babel/cli åè¿˜éœ€è¦å®‰è£… @babel/core

    # ğŸ›´2- å®‰è£…å®Œè¿™ä¸¤ä¸ªæ’ä»¶å, å¦‚æœåœ¨ Mac ç¯å¢ƒä¸‹æ‰§è¡Œä¼šå‡ºç° command not found: babel, è¿™æ˜¯å› ä¸º @babel/cliæ˜¯å®‰è£…åœ¨é¡¹ç›®ä¸‹, è€Œä¸æ˜¯å…¨å±€å®‰è£…, æ‰€ä»¥æ— æ³•ç›´æ¥ä½¿ç”¨ Babel å‘½ä»¤,éœ€è¦åœ¨ package.json æ–‡ä»¶ä¸­åŠ ä¸Šä¸‹é¢è¿™ä¸ªé…ç½®é¡¹:
    "scripts": {
        "babel": "babel"
    }

    # ğŸ›´3- ç„¶åæ‰§è¡Œ npm run babel ./test.js, é¡ºåˆ©ç”Ÿæˆä»£ç , æ­¤æ—¶ç”Ÿæˆçš„ä»£ç å¹¶æ²¡æœ‰è¢«ç¼–è¯‘, å› ä¸º Babel å°†åŸæ¥é›†æˆä¸€ä½“çš„å„ç§ç¼–è¯‘åŠŸèƒ½åˆ†ç¦»å‡ºå», ç‹¬ç«‹æˆæ’ä»¶, è¦ç¼–è¯‘æ–‡ä»¶éœ€è¦å®‰è£…å¯¹åº”çš„æ’ä»¶æˆ–è€…é¢„è®¾, æˆ‘ä»¬ç»å¸¸çœ‹è§çš„ä»€ä¹ˆ @babel/preset-stage-0ã€@babel/preset-stage-1,@babel/preset-env ç­‰å°±æ˜¯å¹²è¿™äº›æ´»çš„.

    # ğŸ›´4- é‚£è¿™äº›æ’ä»¶å’Œé¢„è®¾æ€ä¹ˆç”¨å‘¢? ä¸‹é¢å°±è¦è¯´åˆ° Babel çš„é…ç½®æ–‡ä»¶äº†,è¿™äº›æ’ä»¶éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­äº¤ä»£æ¸…æ¥š,ä¸ç„¶ Babel ä¹Ÿä¸çŸ¥é“ä½ è¦ç”¨å“ªäº›æ’ä»¶å’Œé¢„è®¾.
```

#### é…ç½® Babel é…ç½®æ–‡ä»¶, Babel çš„é…ç½®æ–‡ä»¶æœ‰å››ç§å½¢å¼
```js
// ğŸ’› æ–¹å¼1 babel.config.js
// åœ¨é¡¹ç›®çš„æ ¹ç›®å½•(package.json æ–‡ä»¶æ‰€åœ¨ç›®å½•)ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º babel.config.js çš„æ–‡ä»¶,å¹¶è¾“å…¥å¦‚ä¸‹å†…å®¹.
module.exports = function (api) {
 api.cache(true)
 const presets = [ ... ]
 const plugins = [ ... ]
 return {
   presets,
   plugins
 }
}
```

```js
// ğŸ’› æ–¹å¼2 .babelrc
// åœ¨ä½ çš„é¡¹ç›®ä¸­åˆ›å»ºåä¸º .babelrc çš„æ–‡ä»¶
{
 "presets": [...],
 "plugins": [...]
}
```

```js
// ğŸ’› æ–¹å¼3 .babelrc.js
// ä¸ .babelrc çš„é…ç½®ç›¸åŒ,ä½ å¯ä»¥ä½¿ç”¨ JavaScript è¯­æ³•ç¼–å†™.
const presets = [ ... ];
const plugins = [ ... ];
module.exports = { presets, plugins };
```

```js
// ğŸ’› æ–¹å¼4 package.json
// è¿˜å¯ä»¥é€‰æ‹©å°† .babelrc ä¸­çš„é…ç½®ä¿¡æ¯å†™åˆ° package.json æ–‡ä»¶ä¸­
{
 ...
 "babel": {
   "presets": [ ... ],
   "plugins": [ ... ],
 }
}
```

### â­ Babel Plugins (æ’ä»¶)
æ’ä»¶æ˜¯ç”¨æ¥å®šä¹‰å¦‚ä½•è½¬æ¢ä½ çš„ä»£ç çš„. åœ¨ `Babel` çš„é…ç½®é¡¹ä¸­å¡«å†™éœ€è¦ä½¿ç”¨çš„æ’ä»¶åç§°, `Babel` åœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¼šå»åŠ è½½ `node_modules` ä¸­å¯¹åº”çš„ `npm` åŒ…, ç„¶åç¼–è¯‘æ’ä»¶å¯¹åº”çš„è¯­æ³•. ä»¥`.babelrc`ä¸ºä¾‹:
```js
{
  "plugins": ["transform-decorators-legacy", "transform-class-properties"]
}
```


#### æ’ä»¶æ‰§è¡Œé¡ºåº
- æ’ä»¶åœ¨é¢„è®¾ (`Presets`) å‰è¿è¡Œ
- æ’ä»¶çš„æ‰§è¡Œé¡ºåºæ˜¯ä»å·¦å¾€å³æ‰§è¡Œ. ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­, `Babel` åœ¨è¿›è¡Œ `AST` éå†çš„æ—¶å€™ä¼šå…ˆè°ƒç”¨ `transform-decorators-legacy` æ’ä»¶ä¸­å®šä¹‰çš„è½¬æ¢æ–¹æ³•, ç„¶åå†è°ƒç”¨ `transform-class-properties` ä¸­çš„æ–¹æ³•. 

#### æ’ä»¶ä¼ å‚
- å‚æ•°æ˜¯ç”±æ’ä»¶åç§°å’Œå‚æ•°å¯¹è±¡ç»„æˆçš„ä¸€ä¸ªæ•°ç»„.
```js
{
    "plugins": [
        [
            "@babel/plugin-proposal-class-properties", 
            { "loose": true }
        ]
    ]
}
```

#### æ’ä»¶åç§°
- æ’ä»¶åç§°å¦‚æœä¸º `@babel/plugin-XX`, å¯ä»¥ä½¿ç”¨çŸ­åç§°`@babel/XX` , å¦‚æœä¸º `babel-plugin-xx`, å¯ä»¥ç›´æ¥ä½¿ç”¨ `xx`

#### è‡ªå®šä¹‰æ’ä»¶
- å¾…è¡¥å……

### â­ é¢„è®¾ (Presets)
- `é¢„è®¾` å°±æ˜¯ä¸€å †æ’ä»¶(`Plugin`)çš„ç»„åˆ, ä»è€Œè¾¾åˆ°æŸç§è½¬è¯‘çš„èƒ½åŠ›, å°±æ¯”å¦‚ `react` ä¸­ä½¿ç”¨åˆ°çš„ `@babel/preset-react` , å®ƒå°±æ˜¯ä¸‹é¢å‡ ç§æ’ä»¶çš„ç»„åˆ.
```js
{
  "plugins":["@babel/plugin-syntax-jsx","@babel/plugin-transform-react-jsx","@babel/plugin-transform-react-display-name"]
}
// ä½†æ˜¯è¿™æ ·ä¸€æ–¹é¢æ˜¾å¾—ä¸é‚£ä¹ˆä¼˜é›…, å¦ä¸€æ–¹é¢å¢åŠ äº†ä½¿ç”¨è€…çš„ä½¿ç”¨éš¾åº¦. å¦‚æœç›´æ¥ä½¿ç”¨é¢„è®¾å°±æ¸…æ–°è„±ä¿—å¤šäº†~
{
  "presets":["@babel/preset-react"]
}
```
#### é¢„è®¾(Presets)çš„æ‰§è¡Œé¡ºåº
- `æ’ä»¶`çš„æ‰§è¡Œé¡ºåºæ˜¯`ä»å·¦å¾€å³`
- `é¢„è®¾`çš„æ‰§è¡Œé¡ºåºæ°`ä»å³å¾€å·¦`
```js
{
  "presets": [
    "p-a",
    "p-b",
    "p-c"
  ]
}
// å®ƒçš„æ‰§è¡Œé¡ºåºæ˜¯ p-cã€p-bã€p-a, æ˜¯ä¸æ˜¯æœ‰ç‚¹å¥‡æ€ª, è¿™ä¸»è¦æ˜¯ä¸ºäº†ç¡®ä¿å‘åå…¼å®¹, å› ä¸ºå¤§å¤šæ•°ç”¨æˆ·å°† "es2015" æ”¾åœ¨ "stage-0" ä¹‹å‰.
```

#### å¸¸è§çš„å‡ ç§é¢„è®¾
- ğŸ’› 1): `@babel/preset-stage-xxx`: `@babel/preset-stage-xxx` æ˜¯ ES åœ¨ä¸åŒé˜¶æ®µè¯­æ³•ææ¡ˆçš„è½¬ç è§„åˆ™è€Œäº§ç”Ÿçš„é¢„è®¾, éšç€è¢«æ‰¹å‡†ä¸º ES æ–°ç‰ˆæœ¬çš„ç»„æˆéƒ¨åˆ†è€Œè¿›è¡Œç›¸åº”çš„æ”¹å˜(ä¾‹å¦‚ ES6/ES2015),ææ¡ˆåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªé˜¶æ®µ
```bash
    # stage-0 - è®¾æƒ³ï¼ˆStrawmanï¼‰: åªæ˜¯ä¸€ä¸ªæƒ³æ³•, å¯èƒ½æœ‰ Babel æ’ä»¶, stage-0 çš„åŠŸèƒ½èŒƒå›´æœ€å¹¿å¤§, åŒ…å« stage-1 , stage-2 ä»¥åŠ stage-3 çš„æ‰€æœ‰åŠŸèƒ½
    # stage-1 - å»ºè®®ï¼ˆProposalï¼‰: è¿™æ˜¯å€¼å¾—è·Ÿè¿›çš„
    # stage-2 - è‰æ¡ˆï¼ˆDraftï¼‰: åˆå§‹è§„èŒƒ
    # stage-3 - å€™é€‰ï¼ˆCandidateï¼‰: å®Œæˆè§„èŒƒå¹¶åœ¨æµè§ˆå™¨ä¸Šåˆæ­¥å®ç°
    # stage-4 - å®Œæˆï¼ˆFinishedï¼‰: å°†æ·»åŠ åˆ°ä¸‹ä¸€ä¸ªå¹´åº¦ç‰ˆæœ¬å‘å¸ƒä¸­
```
- ğŸ’› 2): `@babel/preset-es2015`: `preset-es2015` æ˜¯ä»…åŒ…å« `ES6` åŠŸèƒ½çš„ `Babel` é¢„è®¾. å®é™…ä¸Šåœ¨ `Babel7` å‡ºæ¥åä¸Šé¢æåˆ°çš„è¿™äº›é¢„è®¾ `stage-x`, `preset-es2015` éƒ½å¯ä»¥åºŸå¼ƒäº†, å› ä¸º `@babel/preset-env` å‡ºæ¥ä¸€ç»Ÿæ±Ÿæ¹–äº†. 

- ğŸ§¡ 3): `@babel/preset-env`: å‰é¢ä¸¤ä¸ªé¢„è®¾æ˜¯ä» `ES` æ ‡å‡†çš„ç»´åº¦æ¥ç¡®å®šè½¬ç è§„åˆ™çš„, è€Œ `@babel/preset-env` æ˜¯æ ¹æ®æµè§ˆå™¨çš„ä¸åŒç‰ˆæœ¬ä¸­ç¼ºå¤±çš„åŠŸèƒ½ç¡®å®šä»£ç è½¬æ¢è§„åˆ™çš„, åœ¨é…ç½®çš„æ—¶å€™æˆ‘ä»¬åªéœ€è¦é…ç½®éœ€è¦æ”¯æŒçš„æµè§ˆå™¨ç‰ˆæœ¬å°±å¥½äº†, `@babel/preset-env` ä¼šæ ¹æ®ç›®æ ‡æµè§ˆå™¨ç”Ÿæˆå¯¹åº”çš„æ’ä»¶åˆ—è¡¨ç„¶åè¿›è¡Œç¼–è¯‘: 
```js
{
 "presets": [
   ["env", {
     "targets": {
       "browsers": ["last 10 versions", "ie >= 9"]
     }
   }],
 ],
}
```
åœ¨é»˜è®¤æƒ…å†µä¸‹ `@babel/preset-env` æ”¯æŒå°† JS ç›®å‰æœ€æ–°çš„è¯­æ³•è½¬æˆ ES5, ä½†éœ€è¦æ³¨æ„çš„æ˜¯, å¦‚æœä½ ä»£ç ä¸­ç”¨åˆ°äº†è¿˜æ²¡æœ‰æˆä¸º JS æ ‡å‡†çš„è¯­æ³•, è¯¥è¯­æ³•æš‚æ—¶è¿˜å¤„äº `stage` é˜¶æ®µ, è¿™ä¸ªæ—¶å€™è¿˜æ˜¯éœ€è¦å®‰è£…å¯¹åº”çš„ `stage` é¢„è®¾, ä¸ç„¶ç¼–è¯‘ä¼šæŠ¥é”™
```js
{
 "presets": [
   ["env", {
     "targets": {
       "browsers": ["last 10 versions", "ie >= 9"]
     }
   }],
 ],
 "stage-0" // é…åˆ presets/env ä½¿ç”¨
}   
```

- è™½ç„¶å¯ä»¥é‡‡ç”¨é»˜è®¤é…ç½®, ä½†å¦‚æœä¸éœ€è¦ç…§é¡¾æ‰€æœ‰çš„æµè§ˆå™¨, è¿˜æ˜¯å»ºè®®ä½ é…ç½®ç›®æ ‡æµè§ˆå™¨å’Œç¯å¢ƒ, è¿™æ ·å¯ä»¥ä¿è¯ç¼–è¯‘åçš„ä»£ç ä½“ç§¯è¶³å¤Ÿå°, å› ä¸ºåœ¨æœ‰çš„ç‰ˆæœ¬æµè§ˆå™¨ä¸­, æ–°è¯­æ³•æœ¬èº«å°±èƒ½æ‰§è¡Œ, ä¸éœ€è¦ç¼–è¯‘. `@babel/preset-env` åœ¨é»˜è®¤æƒ…å†µä¸‹å’Œ `preset-stage-x` ä¸€æ ·åªç¼–è¯‘è¯­æ³•, ä¸ä¼šå¯¹æ–°æ–¹æ³•å’Œæ–°çš„åŸç”Ÿå¯¹è±¡è¿›è¡Œè½¬è¯‘, ä¾‹å¦‚:

```js
const arrFun = () => {}
const arr = [1,2,3]
console.log(arr.includes(1))

// è½¬æ¢å
"use strict";
var arrFun = function arrFun() {};
var arr = [1, 2, 3];
console.log(arr.includes(1));
// ç®­å¤´å‡½æ•°è¢«è½¬æ¢äº†, ä½†æ˜¯ Array.includes æ–¹æ³•, å¹¶æ²¡æœ‰è¢«å¤„ç†, è¿™ä¸ªæ—¶å€™è¦æ˜¯ç¨‹åºè·‘åœ¨ä½ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸Š, å°±ä¼šå‡ºç° includes is not function çš„é”™è¯¯. è¿™ä¸ªæ—¶å€™å°±éœ€è¦ polyfill é—ªäº®ç™»åœºäº†. 
```

### â­ Polyfill å«ç‰‡
- `polyfill` çš„ç¿»è¯‘è¿‡æ¥å°±æ˜¯å«ç‰‡, å«ç‰‡å°±æ˜¯å«å¹³ä¸åŒæµè§ˆå™¨ç¯å¢ƒçš„å·®å¼‚, è®©å¤§å®¶éƒ½ä¸€æ ·
- `@bable/polyfill`: @babel/polyfill æ¨¡å—å¯ä»¥æ¨¡æ‹Ÿå®Œæ•´çš„ ES5 ç¯å¢ƒ. (`npm install --save @babel/polyfill`)
- æ³¨æ„ `@babel/polyfill` ä¸æ˜¯åœ¨ Babel é…ç½®æ–‡ä»¶ä¸­é…ç½®, è€Œæ˜¯åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­å¼•å…¥.
```js
import '@babel/polyfill';
const arrFun = () = >{}
const arr = [1,2,3]
console.log(arr.includes(1))
Promise.resolve(true)

// ç¼–è¯‘å
require("@babel/polyfill");
var arrFun = function arrFun() {};
var arr = [1, 2, 3];
console.log(arr.includes(1));
Promise.resolve(true);
```

#### useBuiltIns
- `è¿™é‡Œæ˜¯require("@babel/polyfill")`å°†æ•´ä¸ª `@babel/polyfill` åŠ è½½è¿›æ¥äº†, ä½†æ˜¯åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦å¤„ç† `Array`.`includes` å’Œ `Promise` å°±å¥½äº†, å¦‚æœè¿™æ ·å°±ä¼šå¯¼è‡´æˆ‘ä»¬æœ€ç»ˆæ‰“å‡ºæ¥çš„åŒ…ä½“ç§¯å˜å¤§, æ˜¾ç„¶ä¸æ˜¯ä¸€ä¸ªæœ€ä¼˜è§£. è¦æ˜¯èƒ½æŒ‰éœ€åŠ è½½å°±å¥½äº†. å…¶å® Babel æ—©å°±ä¸ºæˆ‘ä»¬æƒ³å¥½äº†. 
- å›è¿‡å¤´æ¥å†è¯´ `@babel/preset-env`, ä»–å‡ºç°çš„ç›®çš„å°±æ˜¯å®ç°æ°‘æ—å¤§ç»Ÿä¸€, è¿ `stage-x` éƒ½å¹²æ‰äº†, åˆæ€ä¹ˆä¼šæ¼æ‰ `Polyfill` è¿™ä¸€åŠŸèƒ½, åœ¨ `@babel/preset-env` çš„é…ç½®é¡¹ä¸­æä¾›äº† `useBuiltIns` è¿™ä¸€å‚æ•°, åªè¦åœ¨ä½¿ç”¨ `@babel/preset-env` çš„æ—¶å€™å¸¦ä¸Šä»–, `Babel` åœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨è¿›è¡Œ `Polyfill` , ä¸å†éœ€è¦æ‰‹åŠ¨çš„åœ¨ä»£ç ä¸­å¼•å…¥ `@babel/polyfill` äº†, åŒæ—¶è¿˜èƒ½åšåˆ°æŒ‰éœ€åŠ è½½
```js
{
  "presets": [
    "@babel/preset-flow",
    [
      "@babel/preset-env",
      {
        "targets": {
          "node": "8.10"
        },
        "corejs": "3", // å£°æ˜ corejs ç‰ˆæœ¬
        "useBuiltIns": "usage"
      }
    ]
  ]
}
// æ³¨æ„, è¿™é‡Œéœ€è¦é…ç½®ä¸€ä¸‹ corejs çš„ç‰ˆæœ¬å·, ä¸é…ç½®ç¼–è¯‘çš„æ—¶å€™ä¼šæŠ¥è­¦å‘Š. è®²éƒ½è®²åˆ°è¿™é‡Œäº†å°±å†é¡ºä¾¿æä¸€å˜´ useBuiltIns çš„æœºæ„å‚æ•°: 
// false: æ­¤æ—¶ä¸å¯¹Polyfill åšæ“ä½œ, å¦‚æœå¼•å…¥ @babel/polyfill åˆ™ä¸ä¼šæŒ‰éœ€åŠ è½½, ä¼šå°†æ‰€æœ‰ä»£ç å¼•å…¥
// usage: ä¼šæ ¹æ®é…ç½®çš„æµè§ˆå™¨å…¼å®¹æ€§, ä»¥åŠä½ ä»£ç ä¸­ä½¿ç”¨åˆ°çš„ API æ¥è¿›è¡Œ Polyfill , å®ç°æŒ‰éœ€åŠ è½½
// entry: ä¼šæ ¹æ®é…ç½®çš„æµè§ˆå™¨å…¼å®¹æ€§, ä»¥åŠä½ ä»£ç ä¸­ä½¿ç”¨åˆ°çš„ API æ¥è¿›è¡Œ Polyfill , å®ç°æŒ‰éœ€åŠ è½½, ä¸è¿‡éœ€è¦åœ¨å…¥å£æ–‡ä»¶ä¸­æ‰‹åŠ¨åŠ ä¸Šimport ' @babel/polyfill'

// ä¹‹å‰çš„ä»£ç ç¼–è¯‘å
"use strict";
require("core-js/modules/es.array.includes");
require("core-js/modules/es.object.to-string");
require("core-js/modules/es.promise");
var arrFun = function arrFun() {};
var arr = [1, 2, 3];
console.log(arr.includes(1));
Promise.resolve(true);
```

#### å…¶ä»–
- å…¶å® Babel åœ¨ç¼–è¯‘ä¸­ä¼šä½¿ç”¨ä¸€äº›è¾…åŠ©å‡½æ•°, è¿™äº›æ–¹æ³•ä¼šè¢« inject åˆ°æ¯ä¸ªæ–‡ä»¶ä¸­,æ²¡æ³•åšåˆ°å¤ç”¨,è¿™æ ·ä¹Ÿä¼šå¯¼è‡´æ‰“åŒ…ä½“ç§¯çš„å¢åŠ .
- `@babel/plugin-transform-runtime`: å¯ä»¥è®© Babel åœ¨ç¼–è¯‘ä¸­å¤ç”¨è¾…åŠ©å‡½æ•°, ä»è€Œå‡å°æ‰“åŒ…æ–‡ä»¶ä½“ç§¯
```bash
    # npm install --save-dev @babel/plugin-transform-runtime
    # npm install --save @babel/runtime
    è¿™ä¸€å¯¹ CP è¦åŒæ—¶å‡ºç°, å½¢å½±ä¸ç¦», æ‰€ä»¥å®‰è£…çš„æ—¶å€™ä½ å°±ä¸€èµ·è£…ä¸Šå§
```
- é…ç½®babel
```js
{
    "presets": [
        [
            "@babel/preset-env",
            {
                "useBuiltIns": "usage",
                "corejs": 3
            }
        ]
    ],
    "plugins": [
       "@babel/plugin-transform-runtime"
    ]
}
```